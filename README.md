# Lesamnta-LW: Lesamnta-LW reference C99 implementation

Lesamnta-LW is a lightweight 256-bit hash function.  The security of Lesamnta-LW is reduced to that of the underlying AES-based block cipher and it is theoretically analyzed for an important application, namely the key-prefix mode.  While most of recently proposed lightweight primitives are hardware-oriented with very small footprints, our main target with Lesamnta-LW is to achieve compact and fast hashing for lightweight application on a wider variety of environments ranging from inexpensive devices to high-end severs at the 2^{120} security level.  As for performance, our primary target CPUs are 8-bit and it is shown that, for short message hashing, Lesamnta-LW offers better tradeoffs between speed and cost on an 8-bit CPU than SHA-256.

This code is based on the following paper.

Technical paper:
[1] S. Hirose, K. Ideguchi, H. Kuwakado, T. Owada, B. Preneel, and H. Yoshida, "An AES based 256-bit hash function for lightweight applications: Lesamnta-LW," IEICE TRANSACTIONS on Fundamentals of Electronics, Communications and Computer Sciences, Vol.E95-A, No.1, pp.89-99, 2012/01/01.

Note: Lesamnta is a registered trademark of Hitachi, Ltd. in Japan.


## Files

+ lesamnta-LW.c: a C99 source code 
+ lesamnta-LW.h: a header file
+ main.c
+ makefile: a makefile for GNU make
+ message1.txt: a message file for test
+ message2.txt: a message file for test
+ message3.txt: a message file for test


## Required tools

+ GNU Make 4.0
+ gcc (GCC) 4.4.5


## Install and test

The simplest way to compile this package is

1. Type `make' to compile the package.
1. Optionally, type `make test' to compute hash values for test vectors.

If you succeeded to compile it, then the output is the following.

./lesamnta-LW --testVector<br>
message: 616263<br>
hashval: ab32ca451748255e3bf0e34a5ad600f0ce7660ecea2fe083ba54139b770766d0<br>
Note: The hash value in the reference is incorrect.<br>

message: 4c4c4c4c4c4c4c4c4c4c4c4c4c4c4c4c4c4c4c4c4c4c4c4c4c4c4c4c4c4c4c4c<br>
hashval: 7a4e03a50be5b5edf3b9ae0a49c8335ee01f65800eea165f8c85b688c36afca3<br>
./lesamnta-LW message1.txt<br>
message: 616263<br>
hashval: ab32ca451748255e3bf0e34a5ad600f0ce7660ecea2fe083ba54139b770766d0<br>
./lesamnta-LW message2.txt<br>
message: 4c4c4c4c4c4c4c4c4c4c4c4c4c4c4c4c4c4c4c4c4c4c4c4c4c4c4c4c4c4c4c4c<br>
hashval: 7a4e03a50be5b5edf3b9ae0a49c8335ee01f65800eea165f8c85b688c36afca3<br>
./lesamnta-LW message3.txt<br>
message: 30313233343536373839303132333435363738393031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839303132333435363738393031323334353637383930313233343536373839<br>
hashval: 6637af08e76c3351437a36ed12f0510e64d403648d1f8a4a5d3a432a50629553

Note: The paper above [1] describes that the hash value of a message "abc" (i.e., 0x61 0x62 0x63) is 25588c1d3 .... The hash value is incorrect. The correct hash value is given as the above: ab32ca4517....


---
Copyright (c) 2015 Hidenori Kuwakado
